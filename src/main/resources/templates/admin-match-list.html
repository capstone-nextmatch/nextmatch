<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê´€ë¦¬ì - ëŒ€íšŒ ëª©ë¡</title>
    <style>
        body { font-family: system-ui, sans-serif; margin: 0; background: #f4f4f9; }
        .admin-header { background: #333; color: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; }
        .admin-header a { color: white; text-decoration: none; margin-left: 20px; }
        .container { max-width: 1200px; margin: 40px auto; padding: 0 20px; }
        h1 { color: #333; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
        .match-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .contest-card { background: white; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); padding: 20px; cursor: pointer; transition: transform 0.2s; }
        .contest-card:hover { transform: translateY(-5px); box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15); }
        .contest-card h3 { margin-top: 0; color: #007bff; }
        .status-badge { display: inline-block; padding: 5px 10px; border-radius: 4px; font-size: 0.8em; }
        .status-upcoming { background: #ffe0b2; color: #ff9800; }
        .status-ongoing { background: #c8e6c9; color: #4caf50; }
    </style>
</head>
<body>
<header class="admin-header">
    <strong>NextMatch ê´€ë¦¬ì í˜ì´ì§€</strong>
    <nav>
        <a href="/admin/match/list">ê²½ê¸° ê²°ê³¼ ê´€ë¦¬</a>
        <a href="/dashboard">ì‚¬ì´íŠ¸ ë©”ì¸</a>
    </nav>
</header>

<div class="container">
    <h1>ê²½ê¸° ê²°ê³¼ ì…ë ¥ ê´€ë¦¬ (ëŒ€íšŒ ì„ íƒ)</h1>

    <div id="contest-list" class="match-list">
    </div>

    <p id="loading-status" style="text-align: center; margin-top: 50px;">ëŒ€íšŒ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
</div>

<script>
    document.addEventListener('DOMContentLoaded', fetchContestList);

    /**
     * APIë¥¼ í†µí•´ ì „ì²´ ëŒ€íšŒ ëª©ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤. (ê¸°ì¡´ /api/event/list ì¬ì‚¬ìš©)
     */
    function fetchContestList() {
        const container = document.getElementById('contest-list');
        const statusMessage = document.getElementById('loading-status');

        // ê¸°ì¡´ì— êµ¬í˜„í•œ ëª©ë¡ APIë¥¼ ì¬ì‚¬ìš©í•©ë‹ˆë‹¤.
        fetch('/api/event/list')
            .then(response => {
                if (!response.ok) throw new Error('API ë¡œë“œ ì‹¤íŒ¨');
                return response.json();
            })
            .then(contests => {
                statusMessage.style.display = 'none';
                if (contests.length === 0) {
                    container.innerHTML = '<p style="grid-column: 1 / -1; text-align: center;">í˜„ì¬ ê´€ë¦¬ ê°€ëŠ¥í•œ ëŒ€íšŒê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                    return;
                }

                contests.forEach(contest => {
                    const card = createContestCard(contest);
                    container.appendChild(card);
                });
            })
            .catch(error => {
                console.error("Error fetching contests:", error);
                statusMessage.textContent = 'ëŒ€íšŒ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
            });
    }

    /**
     * ê°œë³„ ëŒ€íšŒ ì¹´ë“œë¥¼ ìƒì„±í•˜ê³  í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
     */
    function createContestCard(contest) {
        const card = document.createElement('div');
        card.className = 'contest-card';

        const statusClass = contest.status ? contest.status.toLowerCase() : 'unknown';

        card.innerHTML = `
            <h3>${contest.title}</h3>
            <p><strong>ì¢…ëª©:</strong> ${contest.eventCategory}</p>
            <p><strong>í˜•ì‹:</strong> ${contest.format || 'ë¯¸ì •'}</p>
            <p><strong>ì‹œì‘ì¼:</strong> ${contest.startDate}</p>
            <span class="status-badge status-${statusClass}">${contest.status}</span>
        `;

        // ğŸ›‘ ì¹´ë“œ í´ë¦­ ì‹œ, ë‹¤ìŒ ë‹¨ê³„ì¸ ëŒ€ì§„í‘œ ì…ë ¥ í˜ì´ì§€ë¡œ ì´ë™
        card.addEventListener('click', () => {
            // /admin/match/result?contestId=X ë¡œ ì´ë™í•˜ë„ë¡ ì„¤ê³„ (AdminMatchControllerì˜ GetMapping ì¶”ê°€ í•„ìš”)
            window.location.href = `/admin/match/result?contestId=${contest.id}`;
        });

        return card;
    }
</script>
</body>
</html>